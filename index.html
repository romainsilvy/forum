<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Cham Nation</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="/static/css/global.css">
    <link rel="stylesheet" type="text/css" href="/static/css/accueil.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>

<body>
    <header>
        <img id="logo" src="/static/images/logo.png">
        <form method="POST" action="" id="testt">
            <div id="wrap">
                <div id="search">
                    <input name="searchWord" list="list" id="searchTerm" placeholder="Que recherchez-vous ?" value="" autocomplete="off">
                    <button type="submit" id="searchButton"><i class="fas fa-search"></i></button>
                    
                    </button>
                </div>
            </div>
        </form>
        <img id="profile-picture" src="/static/images/profile-picture.png"> 
    </header>
    <div id="global">
        <div class="global-item" id="global-left">
            <div class="item-left item">
                <a href="/">
                    <img id="home" src="/static/images/home.png">
                    <p>Accueil</p>
                </a>
            </div>
            <form action="" method="POST">
                <div id="category">
                    <p>Catégories</p>
                    <input type="submit" name="CHAMEAU" value="CHAMEAU">
                    <input type="submit" name="DROMADAIRE" value="DROMADAIRE">
                    <input type="submit" name="LAMA" value="LAMA">
                </div>
            </form>
        </div>
        <div class="global-item" id="global-center">
            <div class="inside-center" id="add-thread">
                <button id="button-input-add-thread" type="button">+</button>
                <input id="input-add-thread" type="text" placeholder="Ajoutez le nom d'un thread...." value="">
            </div>
            {{range .}}
            <div id="testHour" class="inside-center a-thread"> 
            <form action ="" method="POST" > 
                <button id="buttonDelete" type="button" onclick="javascript:onclickdelete(`{{.Id_th}}`)">Supprimer</button> 
                <button id ="buttonEdit" type="button" onclick="javascript:onclickedit(`{{.Id_th}}`)">Modifier</button> 
            </form>
                <h3>{{.Title}}</h3>
                <p class="zeub">
                    {{.Content}}
                    <button value="likeAdd" name="like" class="btn-like" onclick="like('{{.Id_th}}')" id="green"><i class="fas fa-thumbs-up" aria-hidden="true"></i><span id="btnLike{{.Id_th}}" class="like__number">14</span></button>
                    <button class="btn-dislike" id="red"><i class="fas fa-thumbs-down" aria-hidden="true"></i><span class="like__number">100</span></button>
                </p>
            </div>
            {{end}}
                
        </div>
        <div class="global-item" id="global-right">
        </div>
    </div>

    <div id="pop-up"></div>
    <form id="connexion" class="box" action="" method="POST">
        <h1>Se connecter</h1>
        <input type="text" name="connexionUser" placeholder="Nom d'utilisateur" required="required"/>
        <input type="password" name="connexionPassword" placeholder="Mot de passe" required="required"/>
        <div class="option_div">
            <div class="check_box">
                <input type="checkbox">
                <span>Se rappeler de moi</span>
            </div>
            <div class="forget">
                <a href="">Mot de passe oublié?</a>
            </div>
        </div>
        <div class="input_box button">
            <input type="submit" value="Connexion" name="connect">
        </div>
        <div class="sign_up">
            <p>Pas de compte ?</p><span id="sInscrire">S'inscrire</span>
        </div>
    </form>

    <form id="inscription" class="box" action="" method="POST">
        <h1>Inscription</h1>
        <input type="text" name="inscriptionPseudo" placeholder="Pseudo" required="required"/>
        <input type="email" id="email" name="inscriptionEmail" placeholder="Email" required="required"/>
        <input type="email" id="email" name="inscriptionEmailConfirm" placeholder="Confirmer l'email" required="required"/>
        <input type="password" name="inscriptionPassword" placeholder="Mot de passe" minlength="4" maxlength="12" size="12" required="required"/>
        <input type="password" name="inscriptionPasswordConfirm" placeholder="Confirmer Mot de passe" minlength="4" maxlength="12" size="12" required="required"/>
        <div class="option_div">
            <div class="check_box">
                <input type="checkbox">
                <span>Se rappeler de moi</span>
            </div>
        </div>
            <div class="input_box button">
                <input type="submit" value="Créer un compte" name="submit">
            </div>
    </form>
    
    <form id="thread-background" class="boxthread" action="" method="POST">
        <div id ="ajouter-thread">
            <input value="" type="text" id="namethread" name="threadTitle"></input>
        </div>
        <textarea name="créa_thread" id="créa_thread" cols="70" rows="30" placeholder="Ecrivez votre thread ici"></textarea>
        <ul id="ButtonCategory">
            <li>
            <input type="radio" name="drone" value="CHAMEAU"checked>
            <label for="CHAMEAU">CHAMEAU</label>
            </li>
            <li>
            <input type="radio" name="drone" value="DROMADAIRE">
            <label for="DROMADAIRE">DROMADAIRE</label>
            </li>
            <li>
            <input  type="radio" name="drone" value="LAMA">
            <label for="LAMA">LAMA</label>
            </li>
        </ul>
        <input type="submit" value="Enregistrer" name="submitthread" id="submitthread" class="sub-thread">
    </form>

    <form id="thread-edit" class="boxthread" action="" method="POST">
        <div id ="ajouter-thread">
            <input value="" type="text" id="namethreadedit" name="threadTitle"></input>
        </div>
        <textarea name="créa_thread" id="créa_thread" cols="70" rows="30" placeholder="Ecrivez votre thread ici"></textarea>
        <ul id="ButtonCategory">
            <li>
            <input type="radio" name="drone" value="CHAMEAU"checked>
            <label for="CHAMEAU">CHAMEAU</label>
            </li>
            <li>
            <input type="radio" name="drone" value="DROMADAIRE">
            <label for="DROMADAIRE">DROMADAIRE</label>
            </li>
            <li>
            <input  type="radio" name="drone" value="LAMA">
            <label for="LAMA">LAMA</label>
            </li>
        </ul>
        <input type="submit" value="Modifier" name="submitthread" id="submitthread" class="sub-thread">
    </form>

    <form id="thread-delete" class="boxthread" action="" method="POST">
        <div id ="ajouter-thread">
            <input value="" type="text" id="namethreadedit" name="threadTitle"></input>
        </div>
        <textarea name="créa_thread" id="créa_thread" cols="70" rows="30" placeholder="Ecrivez votre thread ici"></textarea>
        <ul id="ButtonCategory">
            <li>
            <input type="radio" name="drone" value="CHAMEAU"checked>
            <label for="CHAMEAU">CHAMEAU</label>
            </li>
            <li>
            <input type="radio" name="drone" value="DROMADAIRE">
            <label for="DROMADAIRE">DROMADAIRE</label>
            </li>
            <li>
            <input  type="radio" name="drone" value="LAMA">
            <label for="LAMA">LAMA</label>
            </li>
        </ul>
        <input type="submit" value="Supprimer" name="submitthread" id="submitthread" class="sub-thread">
    </form>
</body>
<script>
    
    document.querySelector('#button-input-add-thread').addEventListener('click', ()=>{
        const x = document.getElementById("input-add-thread").value
        if ( x !== "") {
            document.querySelector("#namethread").value = x
            document.querySelector('#thread-background').classList.add("threadGrid")
            document.querySelector('#pop-up').classList.add("connexion-background")

            document.querySelector('#pop-up').addEventListener('click', ()=>{
            document.querySelector('#thread-background').classList.remove("threadGrid")
            document.querySelector('#pop-up').classList.remove("connexion-background")
            })
        }
    })
    
    function like(id_th) {
        console.log(id_th)
        const body_content  = document.querySelectorAll("body")
        console.log(body_content)
        fetch("/like", {
        method : "POST",
        headers : {
            "content-type" : "application/json"
        },
        body : JSON.stringify({// envoyer dans le go
            id_th
        })
        })
        .then((response)=>{
        return response.text()
        })
        .then((result)=>{
            // faire update compteur de like
            const btnName = `#btnLike${id_th.toString()}`
            console.log(btnName)
            document.querySelector(btnName).innerHTML = result
            console.log(result)
        })
        .catch((err) =>{
        throw err
        })
    }


    function onclickedit (postID) {
            console.log(postID)
            document.querySelector('#thread-edit').classList.add("threadGrid")
            document.querySelector('#pop-up').classList.add("connexion-background")

            document.querySelector('#pop-up').addEventListener('click', ()=>{
            document.querySelector('#thread-edit').classList.remove("threadGrid")
            document.querySelector('#pop-up').classList.remove("connexion-background")
            })
    }

    function onclickdelete (postID) {
            console.log(postID)
        
        document.querySelector('#thread-delete').classList.add("threadGrid")
        document.querySelector('#pop-up').classList.add("connexion-background")

        document.querySelector('#pop-up').addEventListener('click', ()=>{
        document.querySelector('#thread-delete').classList.remove("threadGrid")
        document.querySelector('#pop-up').classList.remove("connexion-background")
        })
    }
        var i=0;
        function read(){
            let i=0;
            if (!i){
                document.getElementById("more").style.display ="inline";
                document.getElementById("first-text").style.display ="none";
                document.getElementById("read").innerHTML ="Voir moins";
                i=1;
            } else {
                document.getElementById("more").style.display ="none";
                document.getElementById("first-text").style.display ="inline";
                document.getElementById("read").innerHTML ="Voir plus";
                i=0;
            }
        }

        if (document.querySelector("#testHour")) {
            let btn1 = document.querySelector('#green');
            let btn2 = document.querySelector('#red');

            btn1.addEventListener('click', function() {
        
            if (btn2.classList.contains('red')) {
                btn2.classList.remove('red');
            } 
            this.classList.toggle('green');
            });

            btn2.addEventListener('click', function() {
        
            if (btn1.classList.contains('green')) {
                btn1.classList.remove('green');
            } 
            this.classList.toggle('red');
            });
        }

        document.querySelector('#profile-picture').addEventListener('click', ()=>{

            if (document.cookie.includes("auth")) {
                window.location.replace('http://localhost:8080/profil')
            } else {

                document.querySelector('#pop-up').classList.add("connexion-background")
                document.querySelector('#connexion').classList.add("popUp")

                document.querySelector('#sInscrire').addEventListener('click', ()=>{
                    document.querySelector('#connexion').classList.remove("popUp")
                    document.querySelector('#inscription').classList.add("popUp")
                })

                document.querySelector('#pop-up').addEventListener('click', ()=>{
                    document.querySelector('#pop-up').classList.remove("connexion-background")
                    document.querySelector('#connexion').classList.remove("popUp")
                    document.querySelector('#inscription').classList.remove("popUp")
                })
            }
        }) 


</script>
</html>