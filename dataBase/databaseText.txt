PRAGMA foreign_keys = ON;

CREATE TABLE IF NOT EXISTS User(
    id_user INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    user_name TEXT NOT NULL UNIQUE,
    password TEXT NOT NULL,
    email TEXT NOT NULL,
    image TEXT NOT NULL,
    description TEXT

);

CREATE TABLE IF NOT EXISTS Thread(
    id_th INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    id_user INTEGER NOT NULL,
    title TEXT NOT NULL,
    content TEXT NOT NULL,
    created_at TEXT NOT NULL,
    notif BOOL NOT NULL DEFAULT 0,
    like_count INT NOT NULL,
    dislike_count INT NOT NULL,
    comment_count INT NOT NULL,
    image TEXT NOT NULL,

 	FOREIGN KEY(id_user) REFERENCES User(id_user),
    FOREIGN KEY(image) REFERENCES User(image)
);


CREATE TABLE IF NOT EXISTS ThreadMessage(
    id_th_msg INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    id_th INTEGER NOT NULL,
    id_user INTEGER NOT NULL,
    created_at TEXT NOT NULL,
    msg_content TEXT NOT NULL,
    image TEXT NOT NULL,

    FOREIGN KEY(id_user) REFERENCES User(id_user),
    FOREIGN KEY(id_th) REFERENCES Thread(id_th),
    FOREIGN KEY(image) REFERENCES User(image)
);


CREATE TABLE IF NOT EXISTS Like(
    id_like INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    id_user INTEGER NOT NULL,
    like BOOL NOT NULL DEFAULT 0,
    dislike BOOL NOT NULL DEFAULT 0,
    id_th INT NOT NULL,

    FOREIGN KEY(id_user) REFERENCES User(id_user),
    FOREIGN KEY(id_th) REFERENCES Thread(id_th)
);

CREATE TABLE IF NOT EXISTS Following(
    id_following INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    id_user INTEGER NOT NULL,
    id_th INTEGER NOT NULL,
    image TEXT NOT NULL,

    FOREIGN KEY(id_user) REFERENCES User(id_user),
    FOREIGN KEY(id_th) REFERENCES Thread(id_th),
    FOREIGN KEY(image) REFERENCES User(image)
);


CREATE TABLE IF NOT EXISTS ThreadCategory(
    id_th_cat INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    id_cat INTEGER NOT NULL,
    id_th INT NOT NULL,

    FOREIGN KEY(id_cat) REFERENCES Category(id_cat),
    FOREIGN KEY(id_th) REFERENCES Thread(id_th)
);


CREATE TABLE IF NOT EXISTS Category(
    id_cat INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
    cat_name TEXT NOT NULL

);
